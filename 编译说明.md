# ğŸ“¦ ç¼–è¯‘è¯´æ˜

## ğŸš€ å¿«é€Ÿç¼–è¯‘

é¡¹ç›®æä¾›äº†ä¸¤ä¸ªä¾¿æ·çš„ç¼–è¯‘è„šæœ¬ï¼š

### 1ï¸âƒ£ ç¼–è¯‘ CPU ç‰ˆæœ¬
```bash
./build_cpu.sh
```
- è¾“å‡ºç›®å½•ï¼š`build_cpu/bin/meshDistCPU`
- ä½¿ç”¨ OpenMP å¤šçº¿ç¨‹

### 2ï¸âƒ£ ç¼–è¯‘ GPU ç‰ˆæœ¬  
```bash
./build_gpu.sh
```
- è¾“å‡ºç›®å½•ï¼š`build/bin/meshDistGPU`
- ä½¿ç”¨ CUDA GPU åŠ é€Ÿ

---

## ğŸ“‚ ç›®å½•ç»“æ„

ç¼–è¯‘åçš„ç›®å½•ç»“æ„ï¼š
```
gpuhw/
â”œâ”€â”€ build/                    # GPU ç‰ˆæœ¬æ„å»ºç›®å½•
â”‚   â””â”€â”€ bin/meshDistGPU      # GPU å¯æ‰§è¡Œæ–‡ä»¶ (2.1M)
â”œâ”€â”€ build_cpu/               # CPU ç‰ˆæœ¬æ„å»ºç›®å½•
â”‚   â””â”€â”€ bin/meshDistCPU      # CPU å¯æ‰§è¡Œæ–‡ä»¶ (1.3M)
â”œâ”€â”€ build_cpu.sh             # CPU ç‰ˆæœ¬ç¼–è¯‘è„šæœ¬
â”œâ”€â”€ build_gpu.sh             # GPU ç‰ˆæœ¬ç¼–è¯‘è„šæœ¬
â””â”€â”€ data/                    # æµ‹è¯•æ•°æ®
```

---

## âœ… æµ‹è¯•è¿è¡Œ

### CPU ç‰ˆæœ¬
```bash
cd build_cpu
./bin/meshDistCPU --headless data/my-bunny.obj data/alien-animal.obj
```

### GPU ç‰ˆæœ¬
```bash
cd build
./bin/meshDistGPU --headless data/my-bunny.obj data/alien-animal.obj
```

### å¯¹æ¯”æµ‹è¯•ï¼ˆå¤§æ¨¡å‹ï¼‰
```bash
# CPU ç‰ˆæœ¬
cd build_cpu
time ./bin/meshDistCPU --headless data/buddha.obj data/wheeler.obj
# é¢„æœŸ: ~7.6 ç§’

# GPU ç‰ˆæœ¬
cd ../build
time ./bin/meshDistGPU --headless data/buddha.obj data/wheeler.obj
# é¢„æœŸ: ~0.32 ç§’ (24å€åŠ é€Ÿï¼)
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| ç‰ˆæœ¬ | å°æ¨¡å‹ (34kÃ—23k) | å¤§æ¨¡å‹ (427kÃ—100k) |
|------|-----------------|-------------------|
| **CPU** | 0.24 ç§’ | 7.64 ç§’ |
| **GPU** | 0.25 ç§’ | 0.32 ç§’ |
| **åŠ é€Ÿæ¯”** | 0.96x | **23.9x** ğŸš€ |

**ç»“è®º**ï¼šGPU åœ¨å¤§è§„æ¨¡è®¡ç®—æ—¶ä¼˜åŠ¿æ˜æ˜¾ï¼

---

## ğŸ”§ è„šæœ¬è¯¦ç»†è¯´æ˜

### `build_cpu.sh` - CPU ç‰ˆæœ¬ç¼–è¯‘è„šæœ¬

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨åˆ›å»º `build_cpu` ç›®å½•
- é…ç½® CMake (`USE_GPU=OFF`)
- å¤šæ ¸å¹¶è¡Œç¼–è¯‘
- éªŒè¯å¯æ‰§è¡Œæ–‡ä»¶
- æ˜¾ç¤ºè¿è¡Œæ–¹å¼

**ç‰¹ç‚¹**ï¼š
- âœ… ä¸æ¸…ç©ºæ—§æ–‡ä»¶ï¼ˆå¢é‡ç¼–è¯‘æ›´å¿«ï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹ç¼–è¯‘é”™è¯¯
- âœ… å‹å¥½çš„æç¤ºä¿¡æ¯

### `build_gpu.sh` - GPU ç‰ˆæœ¬ç¼–è¯‘è„šæœ¬

**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨è®¾ç½® CUDA ç¼–è¯‘å™¨è·¯å¾„
- æ£€æŸ¥ nvcc æ˜¯å¦å­˜åœ¨
- æ¸…ç©º `build` ç›®å½•ï¼ˆé¿å…å†²çªï¼‰
- é…ç½® CMake (`USE_GPU=ON`)
- å¤šæ ¸å¹¶è¡Œç¼–è¯‘
- éªŒè¯å¯æ‰§è¡Œæ–‡ä»¶
- æ˜¾ç¤ºè¿è¡Œæ–¹å¼

**ç‰¹ç‚¹**ï¼š
- âœ… æ¯æ¬¡æ¸…ç©ºæ—§æ–‡ä»¶ï¼ˆé¿å… CUDA ç¼–è¯‘ç¼“å­˜é—®é¢˜ï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹ CUDA ç¼–è¯‘å™¨
- âœ… å‹å¥½çš„æç¤ºä¿¡æ¯

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: ç¼–è¯‘å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**CPU ç‰ˆæœ¬**ï¼š
```bash
# æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…
sudo apt-get install -y freeglut3-dev libgl1-mesa-dev
```

**GPU ç‰ˆæœ¬**ï¼š
```bash
# æ£€æŸ¥ CUDA æ˜¯å¦æ­£ç¡®å®‰è£…
nvcc --version

# æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®
ls -l /home/jiaxingliu/miniconda3/bin/nvcc
```

### Q2: å¦‚ä½•ä¿®æ”¹ CUDA ç¼–è¯‘å™¨è·¯å¾„ï¼Ÿ

ç¼–è¾‘ `build_gpu.sh`ï¼Œä¿®æ”¹ç¬¬ 12 è¡Œï¼š
```bash
export CUDACXX=/your/path/to/nvcc
```

### Q3: æƒ³åŒæ—¶æ‹¥æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Ÿ

ç›´æ¥è¿è¡Œä¸¤ä¸ªè„šæœ¬å³å¯ï¼š
```bash
./build_cpu.sh  # ç”Ÿæˆ build_cpu/bin/meshDistCPU
./build_gpu.sh  # ç”Ÿæˆ build/bin/meshDistGPU
```

ä¸¤ä¸ªç‰ˆæœ¬äº’ä¸å¹²æ‰°ï¼Œå¯ä»¥å…±å­˜ï¼

### Q4: å¦‚ä½•æ¸…ç†æ„å»ºæ–‡ä»¶ï¼Ÿ

```bash
# æ¸…ç† CPU ç‰ˆæœ¬
rm -rf build_cpu

# æ¸…ç† GPU ç‰ˆæœ¬
rm -rf build

# æ¸…ç†å…¨éƒ¨
rm -rf build build_cpu
```

---

## ğŸ“ æ‰‹åŠ¨ç¼–è¯‘ï¼ˆä¸ä½¿ç”¨è„šæœ¬ï¼‰

### CPU ç‰ˆæœ¬
```bash
mkdir -p build_cpu && cd build_cpu
cmake -DUSE_GPU=OFF ..
make -j$(nproc)
```

### GPU ç‰ˆæœ¬
```bash
mkdir -p build && cd build
export CUDACXX=/home/jiaxingliu/miniconda3/bin/nvcc
cmake -DUSE_GPU=ON ..
make -j$(nproc)
```

---

## ğŸ“ ä½œä¸šæäº¤å»ºè®®

æ¨èåŒæ—¶æäº¤ä¸¤ä¸ªç‰ˆæœ¬ï¼š

1. **ç¼–è¯‘ä¸¤ä¸ªç‰ˆæœ¬**
   ```bash
   ./build_cpu.sh
   ./build_gpu.sh
   ```

2. **æ€§èƒ½æµ‹è¯•å¯¹æ¯”**
   ```bash
   # æµ‹è¯•å¹¶è®°å½•æ—¶é—´
   time ./build_cpu/bin/meshDistCPU --headless data/buddha.obj data/wheeler.obj
   time ./build/bin/meshDistGPU --headless data/buddha.obj data/wheeler.obj
   ```

3. **éªŒè¯ç»“æœä¸€è‡´æ€§**
   - æ£€æŸ¥ä¸¤ä¸ªç‰ˆæœ¬çš„é¡¶ç‚¹å¯¹æ˜¯å¦ç›¸åŒ
   - æ£€æŸ¥æœ€å°è·ç¦»æ˜¯å¦ä¸€è‡´

4. **æäº¤å†…å®¹**
   - `src/mesh_distance.cu` - GPU å®ç°ä»£ç 
   - `build_cpu/bin/meshDistCPU` - CPU å¯æ‰§è¡Œæ–‡ä»¶
   - `build/bin/meshDistGPU` - GPU å¯æ‰§è¡Œæ–‡ä»¶
   - æ€§èƒ½æµ‹è¯•æŠ¥å‘Šï¼ˆCPU vs GPUï¼‰

---

## ğŸ‰ ç¥ç¼–è¯‘æˆåŠŸï¼

æœ‰é—®é¢˜æ¬¢è¿éšæ—¶å’¨è¯¢ï¼ğŸš€

